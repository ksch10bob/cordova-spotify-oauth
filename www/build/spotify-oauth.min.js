(()=>{var e={409:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)((function(t,r){var o;try{o=e.apply(this,t)}catch(e){return r(e)}(0,n.default)(o)&&"function"==typeof o.then?o.then((function(e){a(r,null,e)}),(function(e){a(r,e.message?e:new Error(e))})):r(null,o)}))};var n=s(r(218)),o=s(r(519)),i=s(r(111));function s(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r){try{e(t,r)}catch(e){(0,i.default)(u,e)}}function u(e){throw e}e.exports=t.default},626:(e,t)=>{"use strict";function r(){this.head=this.tail=null,this.length=0}function n(e,t){e.length=1,e.head=e.tail=t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,r.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},r.prototype.empty=function(){for(;this.head;)this.shift();return this},r.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},r.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},r.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):n(this,e)},r.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):n(this,e)},r.prototype.shift=function(){return this.head&&this.removeLink(this.head)},r.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},r.prototype.toArray=function(){for(var e=Array(this.length),t=this.head,r=0;r<this.length;r++)e[r]=t.data,t=t.next;return e},r.prototype.remove=function(e){for(var t=this.head;t;){var r=t.next;e(t)&&this.removeLink(t),t=r}return this},e.exports=t.default},519:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){var t=(0,o.default)(arguments),r=t.pop();e.call(this,t,r)}};var n,o=(n=r(33))&&n.__esModule?n:{default:n};e.exports=t.default},362:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}},e.exports=t.default},714:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var c=(0,f.default)(e),h=0,l=[],d=!1;function p(e,t,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(m.started=!0,(0,o.default)(e)||(e=[e]),0===e.length&&m.idle())return(0,a.default)((function(){m.drain()}));for(var n=0,s=e.length;n<s;n++){var u={data:e[n],callback:r||i.default};t?m._tasks.unshift(u):m._tasks.push(u)}d||(d=!0,(0,a.default)((function(){d=!1,m.process()})))}function y(e){return function(t){h-=1;for(var r=0,o=e.length;r<o;r++){var i=e[r],s=(0,n.default)(l,i,0);0===s?l.shift():s>0&&l.splice(s,1),i.callback.apply(i,arguments),null!=t&&m.error(t,i.data)}h<=m.concurrency-m.buffer&&m.unsaturated(),m.idle()&&m.drain(),m.process()}}var b=!1,m={_tasks:new u.default,concurrency:t,payload:r,saturated:i.default,unsaturated:i.default,buffer:t/4,empty:i.default,drain:i.default,error:i.default,started:!1,paused:!1,push:function(e,t){p(e,!1,t)},kill:function(){m.drain=i.default,m._tasks.empty()},unshift:function(e,t){p(e,!0,t)},remove:function(e){m._tasks.remove(e)},process:function(){if(!b){for(b=!0;!m.paused&&h<m.concurrency&&m._tasks.length;){var e=[],t=[],r=m._tasks.length;m.payload&&(r=Math.min(r,m.payload));for(var n=0;n<r;n++){var o=m._tasks.shift();e.push(o),l.push(o),t.push(o.data)}h+=1,0===m._tasks.length&&m.empty(),h===m.concurrency&&m.saturated();var i=(0,s.default)(y(e));c(t,i)}b=!1}},length:function(){return m._tasks.length},running:function(){return h},workersList:function(){return l},idle:function(){return m._tasks.length+h===0},pause:function(){m.paused=!0},resume:function(){!1!==m.paused&&(m.paused=!1,(0,a.default)(m.process))}};return m};var n=c(r(118)),o=c(r(469)),i=c(r(308)),s=c(r(362)),a=c(r(111)),u=c(r(626)),f=c(r(993));function c(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},111:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasNextTick=t.hasSetImmediate=void 0,t.fallback=u,t.wrap=f;var n,o,i=(n=r(33))&&n.__esModule?n:{default:n},s=t.hasSetImmediate="function"==typeof setImmediate&&setImmediate,a=t.hasNextTick="object"==typeof process&&"function"==typeof process.nextTick;function u(e){setTimeout(e,0)}function f(e){return function(t){var r=(0,i.default)(arguments,1);e((function(){t.apply(null,r)}))}}o=s?setImmediate:a?process.nextTick:u,t.default=f(o)},33:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){t|=0;for(var r=Math.max(e.length-t,0),n=Array(r),o=0;o<r;o++)n[o]=e[t+o];return n},e.exports=t.default},993:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAsync=void 0;var n,o=(n=r(409))&&n.__esModule?n:{default:n},i="function"==typeof Symbol;function s(e){return i&&"AsyncFunction"===e[Symbol.toStringTag]}t.default=function(e){return s(e)?(0,o.default)(e):e},t.isAsync=s},735:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=(0,o.default)(e);return(0,n.default)((function(e,t){r(e[0],t)}),t,1)};var n=i(r(714)),o=i(r(993));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},848:e=>{e.exports=function(e,t,r,n){for(var o=e.length,i=r+(n?1:-1);n?i--:++i<o;)if(t(e[i],i,e))return i;return-1}},118:(e,t,r)=>{var n=r(848),o=r(722),i=r(351);e.exports=function(e,t,r){return t==t?i(e,t,r):n(e,o,r)}},722:e=>{e.exports=function(e){return e!=e}},351:e=>{e.exports=function(e,t,r){for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}},469:e=>{var t=Array.isArray;e.exports=t},218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},308:e=>{e.exports=function(){}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{"use strict";r.r(n),r.d(n,{LOCAL_STORAGE_KEY:()=>S,authorize:()=>U,forget:()=>R});var e="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==e&&e,t="URLSearchParams"in e,o="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in e,a="ArrayBuffer"in e;if(a)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=ArrayBuffer.isView||function(e){return e&&u.indexOf(Object.prototype.toString.call(e))>-1};function c(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function h(e){return"string"!=typeof e&&(e=String(e)),e}function l(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function p(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function y(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function b(e){var t=new FileReader,r=y(t);return t.readAsArrayBuffer(e),r}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(e){var r;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:t&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&i&&(r=e)&&DataView.prototype.isPrototypeOf(r)?(this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||f(e))?this._bodyArrayBuffer=m(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer)):this.blob().then(b)}),this.text=function(){var e,t,r,n=p(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,r=y(t=new FileReader),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=c(e),t=h(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},d.prototype.delete=function(e){delete this.map[c(e)]},d.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},d.prototype.set=function(e,t){this.map[c(e)]=h(t)},d.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},d.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),l(e)},d.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),l(e)},d.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),l(e)},o&&(d.prototype[Symbol.iterator]=d.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function g(e,t){if(!(this instanceof g))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r,n,o=(t=t||{}).body;if(e instanceof g){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=(n=(r=t.method||this.method||"GET").toUpperCase(),w.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(o),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var i=/([?&])_=[^&]*/;i.test(this.url)?this.url=this.url.replace(i,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function _(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function x(e,t){if(!(this instanceof x))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}g.prototype.clone=function(){return new g(this,{body:this._bodyInit})},v.call(g.prototype),v.call(x.prototype),x.prototype.clone=function(){return new x(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},x.error=function(){var e=new x(null,{status:0,statusText:""});return e.type="error",e};var T=[301,302,303,307,308];x.redirect=function(e,t){if(-1===T.indexOf(t))throw new RangeError("Invalid status code");return new x(null,{status:t,headers:{location:e}})};var A=e.DOMException;try{new A}catch(e){(A=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack}).prototype=Object.create(Error.prototype),A.prototype.constructor=A}function E(t,r){return new Promise((function(n,o){var s=new g(t,r);if(s.signal&&s.signal.aborted)return o(new A("Aborted","AbortError"));var u=new XMLHttpRequest;function f(){u.abort()}u.onload=function(){var e,t,r={status:u.status,statusText:u.statusText,headers:(e=u.getAllResponseHeaders()||"",t=new d,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}})),t)};r.url="responseURL"in u?u.responseURL:r.headers.get("X-Request-URL");var o="response"in u?u.response:u.responseText;setTimeout((function(){n(new x(o,r))}),0)},u.onerror=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},u.ontimeout=function(){setTimeout((function(){o(new TypeError("Network request failed"))}),0)},u.onabort=function(){setTimeout((function(){o(new A("Aborted","AbortError"))}),0)},u.open(s.method,function(t){try{return""===t&&e.location.href?e.location.href:t}catch(e){return t}}(s.url),!0),"include"===s.credentials?u.withCredentials=!0:"omit"===s.credentials&&(u.withCredentials=!1),"responseType"in u&&(i?u.responseType="blob":a&&s.headers.get("Content-Type")&&-1!==s.headers.get("Content-Type").indexOf("application/octet-stream")&&(u.responseType="arraybuffer")),!r||"object"!=typeof r.headers||r.headers instanceof d?s.headers.forEach((function(e,t){u.setRequestHeader(t,e)})):Object.getOwnPropertyNames(r.headers).forEach((function(e){u.setRequestHeader(e,h(r.headers[e]))})),s.signal&&(s.signal.addEventListener("abort",f),u.onreadystatechange=function(){4===u.readyState&&s.signal.removeEventListener("abort",f)}),u.send(void 0===s._bodyInit?null:s._bodyInit)}))}E.polyfill=!0,e.fetch||(e.fetch=E,e.Headers=d,e.Request=g,e.Response=x);var k=r(735),O=r.n(k),P=cordova.exec,j=O()((function(e,t){var r=e.methodName,n=e.args;P((function(e){return setTimeout((function(){return t(null,e)}))}),(function(e){return setTimeout((function(){return t(e)}))}),"SpotifyOAuth",r,n||[])})),B=function(){return B=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},B.apply(this,arguments)},S="SpotifyOAuthData";function U(e){if(!e.clientId)throw new Error("missing clientId");if(!e.redirectUrl)throw new Error("missing redirectUri");if(!Array.isArray(e.scopes))throw new Error("missing scopes");if(!e.tokenExchangeUrl)throw new Error("missing tokenExchangeUrl");if(!e.tokenRefreshUrl)throw new Error("missing tokenRefreshUrl");if((e.refreshSafetyMargin||0)<0)throw new Error("safety margin < 0");var t=localStorage.getItem(S);if(!t)return D(I(e),e.scopes,"auth_failed");var r=JSON.parse(t),n=null!=e.refreshSafetyMargin?e.refreshSafetyMargin:3e4,o=Date.now()+n;return function(e,t){if(e==t)return!0;if(!e||!t||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}(r.scopes,e.scopes)?r.expiresAt>o?Promise.resolve(r):D(function(e,t){return fetch(e.tokenRefreshUrl,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"refresh_token="+encodeURIComponent(t.encryptedRefreshToken)}).then(M).then((function(e){return e.json()})).then((function(e){var r=e.access_token,n=e.expires_in;return{accessToken:r,encryptedRefreshToken:t.encryptedRefreshToken,expiresAt:1e3*n+Date.now()}}))}(e,r),e.scopes,"refresh_failed"):D(I(e),e.scopes,"auth_failed")}function R(){return localStorage.removeItem(S)}function I(e){return(t="getCode",r=[e.clientId,e.redirectUrl,e.tokenExchangeUrl,e.tokenRefreshUrl,e.scopes],void 0===r&&(r=[]),new Promise((function(e,n){return j.push({methodName:t,args:r},(function(t,r){return t?n(t):e(r)}))})).catch((function(e){var t=e.type,r=e.msg,n=new Error(r);return n.name=t,Promise.reject(n)}))).then((function(t){var r=t.code;return fetch(e.tokenExchangeUrl,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"code="+r})})).then(M).then((function(e){return e.json()})).then((function(e){var t=e.access_token,r=e.expires_in;return{accessToken:t,encryptedRefreshToken:e.refresh_token,expiresAt:1e3*r+Date.now()}}));var t,r}function M(e){return e.ok?Promise.resolve(e):Promise.reject(Promise.reject(new Error("got invalid HTTP status code "+e.status)))}function D(e,t,r){return e.then((function(e){return localStorage.setItem(S,JSON.stringify(B(B({},e),{scopes:t}))),e})).catch((function(e){var t=new Error(e.message);return t.name=r,Promise.reject(t)}))}})(),exports.spotifyAuth=n})();
//# sourceMappingURL=spotify-oauth.min.js.map